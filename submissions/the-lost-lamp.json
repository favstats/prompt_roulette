{
  "title": "The Lost Lamp",
  "author": "favstats",
  "theme": "You're a genie whose lamp gets lost and you must find it",
  "genre": "Hangman with a twist",
  "twist": "Music is the narrator",
  "difficulty": "normal",
  "description": "The Lost Lamp is a musical hangman game where you play as a genie whose magical lamp has been scattered across mystical realms. Solve five enchanted words to complete the \"Song of Summoning\" and call your lamp home. The twist? Music narrates your journey‚Äîcorrect guesses build a harmonious melody while mistakes create dissonance. Watch your genie fade as essence drains, listen for the music's guidance, and restore the magic before it's too late.",
  "submitted": "2025-12-24",
  "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>üßû The Lost Lamp - A Musical Hangman</title>\n    <style>\n        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Quicksand:wght@400;600&display=swap');\n        \n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        :root {\n            --gold: #ffd700;\n            --purple-dark: #1a0a2e;\n            --purple-mid: #3d1a5c;\n            --purple-light: #6b3fa0;\n            --cyan-glow: #00ffff;\n            --pink-glow: #ff69b4;\n            --magic-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        }\n        \n        body {\n            min-height: 100vh;\n            background: var(--purple-dark);\n            font-family: 'Quicksand', sans-serif;\n            color: white;\n            overflow-x: hidden;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        /* Starfield Background */\n        .stars {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            pointer-events: none;\n            z-index: 0;\n        }\n        \n        .star {\n            position: absolute;\n            background: white;\n            border-radius: 50%;\n            animation: twinkle 2s infinite;\n        }\n        \n        @keyframes twinkle {\n            0%, 100% { opacity: 0.3; transform: scale(1); }\n            50% { opacity: 1; transform: scale(1.2); }\n        }\n        \n        /* Main Container */\n        .game-container {\n            position: relative;\n            z-index: 1;\n            max-width: 900px;\n            width: 95%;\n            padding: 30px;\n            background: rgba(61, 26, 92, 0.6);\n            border-radius: 30px;\n            border: 3px solid rgba(255, 215, 0, 0.3);\n            box-shadow: \n                0 0 60px rgba(107, 63, 160, 0.5),\n                inset 0 0 60px rgba(0, 255, 255, 0.05);\n            backdrop-filter: blur(10px);\n        }\n        \n        /* Header */\n        .header {\n            text-align: center;\n            margin-bottom: 20px;\n        }\n        \n        .title {\n            font-family: 'Cinzel', serif;\n            font-size: 2.5rem;\n            background: linear-gradient(90deg, var(--gold), #fff, var(--gold));\n            -webkit-background-clip: text;\n            background-clip: text;\n            -webkit-text-fill-color: transparent;\n            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);\n            margin-bottom: 5px;\n        }\n        \n        .subtitle {\n            color: var(--cyan-glow);\n            font-size: 1rem;\n            opacity: 0.8;\n        }\n        \n        /* Progress Bar */\n        .progress-container {\n            display: flex;\n            justify-content: center;\n            gap: 15px;\n            margin: 20px 0;\n        }\n        \n        .progress-note {\n            width: 50px;\n            height: 50px;\n            border-radius: 50%;\n            background: rgba(255, 255, 255, 0.1);\n            border: 2px solid rgba(255, 215, 0, 0.3);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 1.5rem;\n            transition: all 0.5s ease;\n            position: relative;\n        }\n        \n        .progress-note.completed {\n            background: linear-gradient(135deg, var(--gold), #ff8c00);\n            border-color: var(--gold);\n            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);\n            animation: noteComplete 0.6s ease;\n        }\n        \n        .progress-note.current {\n            border-color: var(--cyan-glow);\n            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);\n            animation: pulse 1.5s infinite;\n        }\n        \n        @keyframes noteComplete {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.3) rotate(10deg); }\n            100% { transform: scale(1); }\n        }\n        \n        @keyframes pulse {\n            0%, 100% { box-shadow: 0 0 15px rgba(0, 255, 255, 0.5); }\n            50% { box-shadow: 0 0 25px rgba(0, 255, 255, 0.8); }\n        }\n        \n        /* Genie Display */\n        .genie-section {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            gap: 40px;\n            margin: 20px 0;\n        }\n        \n        .genie-container {\n            position: relative;\n            width: 180px;\n            height: 200px;\n        }\n        \n        .genie {\n            position: absolute;\n            width: 100%;\n            height: 100%;\n            transition: all 0.5s ease;\n        }\n        \n        .genie-body {\n            position: absolute;\n            bottom: 0;\n            left: 50%;\n            transform: translateX(-50%);\n            width: 80px;\n            height: 120px;\n            background: linear-gradient(180deg, var(--cyan-glow), var(--purple-light), transparent);\n            border-radius: 40px 40px 50% 50%;\n            opacity: var(--genie-opacity, 1);\n            filter: blur(var(--genie-blur, 0px));\n            animation: float 3s ease-in-out infinite;\n        }\n        \n        .genie-head {\n            position: absolute;\n            top: 20px;\n            left: 50%;\n            transform: translateX(-50%);\n            width: 60px;\n            height: 60px;\n            background: radial-gradient(circle at 30% 30%, var(--cyan-glow), var(--purple-light));\n            border-radius: 50%;\n            opacity: var(--genie-opacity, 1);\n            filter: blur(var(--genie-blur, 0px));\n            animation: float 3s ease-in-out infinite;\n        }\n        \n        .genie-face {\n            position: absolute;\n            top: 35px;\n            left: 50%;\n            transform: translateX(-50%);\n            font-size: 1.5rem;\n            z-index: 10;\n            transition: all 0.3s ease;\n        }\n        \n        .genie-aura {\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            width: 150px;\n            height: 150px;\n            background: radial-gradient(circle, rgba(0, 255, 255, 0.3) 0%, transparent 70%);\n            border-radius: 50%;\n            opacity: var(--genie-opacity, 1);\n            animation: auraGlow 2s ease-in-out infinite;\n        }\n        \n        @keyframes float {\n            0%, 100% { transform: translateX(-50%) translateY(0); }\n            50% { transform: translateX(-50%) translateY(-10px); }\n        }\n        \n        @keyframes auraGlow {\n            0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.5; }\n            50% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.8; }\n        }\n        \n        /* Music Visualizer */\n        .music-visualizer {\n            display: flex;\n            align-items: flex-end;\n            justify-content: center;\n            gap: 4px;\n            height: 80px;\n            padding: 10px;\n            background: rgba(0, 0, 0, 0.3);\n            border-radius: 15px;\n            border: 1px solid rgba(255, 215, 0, 0.2);\n        }\n        \n        .music-bar {\n            width: 8px;\n            background: linear-gradient(to top, var(--purple-light), var(--cyan-glow));\n            border-radius: 4px;\n            transition: height 0.1s ease;\n            min-height: 5px;\n        }\n        \n        .music-bar.wrong {\n            background: linear-gradient(to top, #ff4444, #ff8888) !important;\n        }\n        \n        .music-bar.correct {\n            background: linear-gradient(to top, var(--gold), #fff) !important;\n        }\n        \n        /* Lives Display */\n        .lives-container {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .lives-label {\n            color: var(--gold);\n            font-size: 0.9rem;\n            text-transform: uppercase;\n            letter-spacing: 2px;\n        }\n        \n        .lives {\n            display: flex;\n            gap: 8px;\n        }\n        \n        .life {\n            font-size: 1.8rem;\n            transition: all 0.3s ease;\n            filter: drop-shadow(0 0 5px var(--gold));\n        }\n        \n        .life.lost {\n            opacity: 0.2;\n            filter: grayscale(1);\n            transform: scale(0.8);\n        }\n        \n        /* Word Display */\n        .word-section {\n            text-align: center;\n            margin: 30px 0;\n        }\n        \n        .word-hint {\n            color: var(--pink-glow);\n            font-size: 1.1rem;\n            margin-bottom: 15px;\n            font-style: italic;\n        }\n        \n        .word-display {\n            display: flex;\n            justify-content: center;\n            gap: 10px;\n            flex-wrap: wrap;\n        }\n        \n        .letter-slot {\n            width: 50px;\n            height: 60px;\n            border-bottom: 4px solid var(--gold);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-family: 'Cinzel', serif;\n            font-size: 2rem;\n            color: white;\n            text-transform: uppercase;\n            transition: all 0.3s ease;\n            position: relative;\n        }\n        \n        .letter-slot.revealed {\n            animation: revealLetter 0.5s ease;\n            color: var(--cyan-glow);\n            text-shadow: 0 0 10px var(--cyan-glow);\n        }\n        \n        .letter-slot.space {\n            border: none;\n            width: 30px;\n        }\n        \n        @keyframes revealLetter {\n            0% { transform: scale(0) rotate(-180deg); }\n            50% { transform: scale(1.3) rotate(10deg); }\n            100% { transform: scale(1) rotate(0); }\n        }\n        \n        /* Keyboard */\n        .keyboard {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            gap: 10px;\n            margin-top: 20px;\n        }\n        \n        .keyboard-row {\n            display: flex;\n            gap: 8px;\n            justify-content: center;\n        }\n        \n        .key {\n            width: 45px;\n            height: 50px;\n            border: 2px solid rgba(255, 215, 0, 0.4);\n            background: rgba(107, 63, 160, 0.5);\n            border-radius: 10px;\n            color: white;\n            font-size: 1.2rem;\n            font-weight: 600;\n            cursor: pointer;\n            transition: all 0.2s ease;\n            text-transform: uppercase;\n            font-family: 'Cinzel', serif;\n        }\n        \n        .key:hover:not(.used) {\n            background: rgba(255, 215, 0, 0.3);\n            transform: translateY(-3px);\n            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);\n        }\n        \n        .key.correct {\n            background: linear-gradient(135deg, #28a745, #20c997);\n            border-color: #28a745;\n            animation: keyCorrect 0.4s ease;\n        }\n        \n        .key.wrong {\n            background: linear-gradient(135deg, #dc3545, #ff6b6b);\n            border-color: #dc3545;\n            opacity: 0.5;\n        }\n        \n        .key.used {\n            cursor: not-allowed;\n            opacity: 0.5;\n        }\n        \n        @keyframes keyCorrect {\n            0%, 100% { transform: scale(1); }\n            50% { transform: scale(1.2); }\n        }\n        \n        /* Buttons */\n        .btn {\n            padding: 15px 35px;\n            font-size: 1.1rem;\n            font-family: 'Cinzel', serif;\n            border: none;\n            border-radius: 30px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            text-transform: uppercase;\n            letter-spacing: 2px;\n        }\n        \n        .btn-primary {\n            background: linear-gradient(135deg, var(--gold), #ff8c00);\n            color: var(--purple-dark);\n            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);\n        }\n        \n        .btn-primary:hover {\n            transform: translateY(-3px);\n            box-shadow: 0 8px 30px rgba(255, 215, 0, 0.6);\n        }\n        \n        .btn-secondary {\n            background: transparent;\n            border: 2px solid var(--cyan-glow);\n            color: var(--cyan-glow);\n        }\n        \n        .btn-secondary:hover {\n            background: rgba(0, 255, 255, 0.1);\n        }\n        \n        /* Overlays */\n        .overlay {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(26, 10, 46, 0.95);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            z-index: 100;\n            opacity: 0;\n            visibility: hidden;\n            transition: all 0.4s ease;\n        }\n        \n        .overlay.active {\n            opacity: 1;\n            visibility: visible;\n        }\n        \n        .overlay-content {\n            max-width: 500px;\n            width: 90%;\n            padding: 40px;\n            background: linear-gradient(135deg, rgba(61, 26, 92, 0.9), rgba(107, 63, 160, 0.9));\n            border-radius: 30px;\n            border: 3px solid var(--gold);\n            text-align: center;\n            transform: scale(0.8);\n            transition: transform 0.4s ease;\n        }\n        \n        .overlay.active .overlay-content {\n            transform: scale(1);\n        }\n        \n        .overlay h2 {\n            font-family: 'Cinzel', serif;\n            font-size: 2rem;\n            color: var(--gold);\n            margin-bottom: 20px;\n        }\n        \n        .overlay p {\n            font-size: 1.1rem;\n            line-height: 1.8;\n            margin-bottom: 15px;\n            color: rgba(255, 255, 255, 0.9);\n        }\n        \n        .overlay .emoji-large {\n            font-size: 4rem;\n            margin: 20px 0;\n        }\n        \n        .overlay .buttons {\n            display: flex;\n            gap: 15px;\n            justify-content: center;\n            margin-top: 25px;\n            flex-wrap: wrap;\n        }\n        \n        /* Help Button */\n        .help-btn {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            width: 50px;\n            height: 50px;\n            border-radius: 50%;\n            background: rgba(107, 63, 160, 0.8);\n            border: 2px solid var(--gold);\n            color: var(--gold);\n            font-size: 1.5rem;\n            cursor: pointer;\n            z-index: 50;\n            transition: all 0.3s ease;\n        }\n        \n        .help-btn:hover {\n            transform: scale(1.1);\n            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);\n        }\n        \n        /* Sound Toggle */\n        .sound-btn {\n            position: fixed;\n            top: 20px;\n            left: 20px;\n            width: 50px;\n            height: 50px;\n            border-radius: 50%;\n            background: rgba(107, 63, 160, 0.8);\n            border: 2px solid var(--cyan-glow);\n            color: var(--cyan-glow);\n            font-size: 1.5rem;\n            cursor: pointer;\n            z-index: 50;\n            transition: all 0.3s ease;\n        }\n        \n        .sound-btn:hover {\n            transform: scale(1.1);\n        }\n        \n        .sound-btn.muted {\n            opacity: 0.5;\n        }\n        \n        /* Win Animation */\n        .lamp-found {\n            position: fixed;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            font-size: 8rem;\n            z-index: 200;\n            animation: lampAppear 1s ease forwards;\n            text-shadow: 0 0 50px rgba(255, 215, 0, 0.8);\n        }\n        \n        @keyframes lampAppear {\n            0% { \n                transform: translate(-50%, -50%) scale(0) rotate(-180deg); \n                opacity: 0;\n            }\n            50% { \n                transform: translate(-50%, -50%) scale(1.5) rotate(20deg); \n            }\n            100% { \n                transform: translate(-50%, -50%) scale(1) rotate(0); \n                opacity: 1;\n            }\n        }\n        \n        /* Narrator Message */\n        .narrator {\n            text-align: center;\n            padding: 15px;\n            background: rgba(0, 0, 0, 0.3);\n            border-radius: 15px;\n            margin-top: 20px;\n            border-left: 4px solid var(--pink-glow);\n            font-style: italic;\n            color: rgba(255, 255, 255, 0.9);\n            min-height: 50px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        \n        .narrator span {\n            animation: fadeIn 0.5s ease;\n        }\n        \n        @keyframes fadeIn {\n            from { opacity: 0; transform: translateY(10px); }\n            to { opacity: 1; transform: translateY(0); }\n        }\n        \n        /* Confetti */\n        .confetti {\n            position: fixed;\n            pointer-events: none;\n            z-index: 150;\n        }\n        \n        /* How to Play List */\n        .how-to-list {\n            text-align: left;\n            margin: 20px 0;\n        }\n        \n        .how-to-list li {\n            margin: 10px 0;\n            padding-left: 10px;\n        }\n        \n        /* Responsive */\n        @media (max-width: 600px) {\n            .title { font-size: 1.8rem; }\n            .genie-section { flex-direction: column; gap: 20px; }\n            .key { width: 32px; height: 40px; font-size: 0.9rem; }\n            .letter-slot { width: 35px; height: 45px; font-size: 1.5rem; }\n            .progress-note { width: 40px; height: 40px; font-size: 1.2rem; }\n        }\n    </style>\n</head>\n<body>\n    <!-- Stars Background -->\n    <div class=\"stars\" id=\"stars\"></div>\n    \n    <!-- Help Button -->\n    <button class=\"help-btn\" id=\"helpBtn\">?</button>\n    \n    <!-- Sound Toggle -->\n    <button class=\"sound-btn\" id=\"soundBtn\">üîä</button>\n    \n    <!-- Main Game Container -->\n    <div class=\"game-container\">\n        <header class=\"header\">\n            <h1 class=\"title\">üßû The Lost Lamp</h1>\n            <p class=\"subtitle\">A Musical Hangman Adventure</p>\n        </header>\n        \n        <!-- Progress Notes -->\n        <div class=\"progress-container\" id=\"progressNotes\">\n            <div class=\"progress-note current\">‚ô™</div>\n            <div class=\"progress-note\">‚ô™</div>\n            <div class=\"progress-note\">‚ô™</div>\n            <div class=\"progress-note\">‚ô™</div>\n            <div class=\"progress-note\">‚ô™</div>\n        </div>\n        \n        <!-- Genie & Visualizer Section -->\n        <div class=\"genie-section\">\n            <div class=\"lives-container\">\n                <span class=\"lives-label\">Essence</span>\n                <div class=\"lives\" id=\"lives\">\n                    <span class=\"life\">‚ú®</span>\n                    <span class=\"life\">‚ú®</span>\n                    <span class=\"life\">‚ú®</span>\n                    <span class=\"life\">‚ú®</span>\n                    <span class=\"life\">‚ú®</span>\n                    <span class=\"life\">‚ú®</span>\n                </div>\n            </div>\n            \n            <div class=\"genie-container\">\n                <div class=\"genie\" id=\"genie\">\n                    <div class=\"genie-aura\"></div>\n                    <div class=\"genie-body\"></div>\n                    <div class=\"genie-head\"></div>\n                    <div class=\"genie-face\" id=\"genieFace\">üòä</div>\n                </div>\n            </div>\n            \n            <div class=\"music-visualizer\" id=\"visualizer\">\n                <!-- Bars generated by JS -->\n            </div>\n        </div>\n        \n        <!-- Word Display -->\n        <div class=\"word-section\">\n            <p class=\"word-hint\" id=\"hint\">Loading...</p>\n            <div class=\"word-display\" id=\"wordDisplay\"></div>\n        </div>\n        \n        <!-- Keyboard -->\n        <div class=\"keyboard\" id=\"keyboard\"></div>\n        \n        <!-- Narrator -->\n        <div class=\"narrator\" id=\"narrator\">\n            <span>üéµ The melody calls out to you... Find the words to summon your lamp! üéµ</span>\n        </div>\n    </div>\n    \n    <!-- Start Overlay -->\n    <div class=\"overlay active\" id=\"startOverlay\">\n        <div class=\"overlay-content\">\n            <h2>üßû The Lost Lamp</h2>\n            <div class=\"emoji-large\">ü™î</div>\n            <p>Your magical lamp has been scattered across the mystical realms! Only by solving the <strong>Song of Summoning</strong> can you call it back.</p>\n            <p>Guess the letters to reveal 5 enchanted words. The music will guide you ‚Äî listen for the melody of success or the discord of mistakes!</p>\n            <div class=\"buttons\">\n                <button class=\"btn btn-primary\" id=\"startBtn\">Begin Quest</button>\n                <button class=\"btn btn-secondary\" id=\"howToBtn\">How to Play</button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- How to Play Overlay -->\n    <div class=\"overlay\" id=\"howToOverlay\">\n        <div class=\"overlay-content\">\n            <h2>üìú How to Play</h2>\n            <ul class=\"how-to-list\">\n                <li>üî§ <strong>Guess letters</strong> using keyboard or clicking</li>\n                <li>‚ú® You have <strong>6 essence points</strong> (lives) per word</li>\n                <li>üéµ <strong>Music narrates</strong> your journey ‚Äî harmony for success, discord for mistakes</li>\n                <li>ü™î Solve <strong>5 words</strong> to complete the Song of Summoning</li>\n                <li>üëÅÔ∏è Watch your genie ‚Äî they fade with each wrong guess!</li>\n            </ul>\n            <div class=\"buttons\">\n                <button class=\"btn btn-primary\" id=\"closeHowTo\">Got It!</button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Win Overlay -->\n    <div class=\"overlay\" id=\"winOverlay\">\n        <div class=\"overlay-content\">\n            <h2>üéâ LAMP FOUND!</h2>\n            <div class=\"emoji-large\">ü™î‚ú®üßû</div>\n            <p>The Song of Summoning is complete! Your magical lamp has returned!</p>\n            <p id=\"winStats\"></p>\n            <div class=\"buttons\">\n                <button class=\"btn btn-primary\" id=\"playAgainWin\">Play Again</button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Lose Overlay -->\n    <div class=\"overlay\" id=\"loseOverlay\">\n        <div class=\"overlay-content\">\n            <h2>üí® Essence Faded</h2>\n            <div class=\"emoji-large\">üò¢</div>\n            <p>Your magical essence has faded... The word was: <strong id=\"revealWord\"></strong></p>\n            <p>But don't despair! Every genie gets another chance...</p>\n            <div class=\"buttons\">\n                <button class=\"btn btn-primary\" id=\"tryAgain\">Try Again</button>\n            </div>\n        </div>\n    </div>\n\n    <script>\n        // ============ AUDIO ENGINE ============\n        class MusicNarrator {\n            constructor() {\n                this.audioContext = null;\n                this.isMuted = false;\n                this.masterGain = null;\n                \n                // Pentatonic scale frequencies for pleasant sounds\n                this.scale = [261.63, 293.66, 329.63, 392.00, 440.00, 523.25, 587.33, 659.25];\n                this.currentNote = 0;\n                \n                // Ambient drone\n                this.droneOsc = null;\n                this.droneGain = null;\n            }\n            \n            init() {\n                if (this.audioContext) return;\n                this.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n                this.masterGain = this.audioContext.createGain();\n                this.masterGain.gain.value = 0.3;\n                this.masterGain.connect(this.audioContext.destination);\n                \n                this.startAmbient();\n            }\n            \n            startAmbient() {\n                if (this.droneOsc) return;\n                \n                this.droneOsc = this.audioContext.createOscillator();\n                this.droneGain = this.audioContext.createGain();\n                \n                this.droneOsc.type = 'sine';\n                this.droneOsc.frequency.value = 65.41; // Low C\n                this.droneGain.gain.value = 0.05;\n                \n                this.droneOsc.connect(this.droneGain);\n                this.droneGain.connect(this.masterGain);\n                this.droneOsc.start();\n            }\n            \n            playNote(frequency, duration = 0.3, type = 'sine') {\n                if (this.isMuted || !this.audioContext) return;\n                \n                const osc = this.audioContext.createOscillator();\n                const gain = this.audioContext.createGain();\n                \n                osc.type = type;\n                osc.frequency.value = frequency;\n                \n                gain.gain.setValueAtTime(0.2, this.audioContext.currentTime);\n                gain.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration);\n                \n                osc.connect(gain);\n                gain.connect(this.masterGain);\n                \n                osc.start();\n                osc.stop(this.audioContext.currentTime + duration);\n            }\n            \n            playCorrect() {\n                // Ascending happy notes\n                const note = this.scale[this.currentNote % this.scale.length];\n                this.playNote(note, 0.4, 'sine');\n                setTimeout(() => this.playNote(note * 1.5, 0.3, 'triangle'), 100);\n                this.currentNote++;\n                \n                // Sparkle effect\n                setTimeout(() => this.playNote(this.scale[7], 0.2, 'sine'), 200);\n            }\n            \n            playWrong() {\n                // Dissonant sound\n                this.playNote(130, 0.3, 'sawtooth');\n                this.playNote(138, 0.3, 'sawtooth');\n                \n                // Sad descending\n                setTimeout(() => this.playNote(200, 0.2, 'triangle'), 150);\n                setTimeout(() => this.playNote(150, 0.3, 'triangle'), 250);\n            }\n            \n            playWordComplete() {\n                // Victory fanfare\n                const fanfare = [392, 523.25, 659.25, 783.99];\n                fanfare.forEach((freq, i) => {\n                    setTimeout(() => this.playNote(freq, 0.4, 'sine'), i * 150);\n                });\n                this.currentNote = 0;\n            }\n            \n            playGameWin() {\n                // Epic victory melody\n                const melody = [523.25, 587.33, 659.25, 783.99, 880, 1046.5];\n                melody.forEach((freq, i) => {\n                    setTimeout(() => {\n                        this.playNote(freq, 0.5, 'sine');\n                        this.playNote(freq * 0.5, 0.5, 'sine');\n                    }, i * 200);\n                });\n            }\n            \n            playGameLose() {\n                // Sad melody\n                const melody = [400, 350, 300, 250];\n                melody.forEach((freq, i) => {\n                    setTimeout(() => this.playNote(freq, 0.5, 'triangle'), i * 300);\n                });\n            }\n            \n            toggleMute() {\n                this.isMuted = !this.isMuted;\n                if (this.droneGain) {\n                    this.droneGain.gain.value = this.isMuted ? 0 : 0.05;\n                }\n                return this.isMuted;\n            }\n        }\n        \n        // ============ VISUALIZER ============\n        class Visualizer {\n            constructor(container) {\n                this.container = container;\n                this.bars = [];\n                this.init();\n            }\n            \n            init() {\n                for (let i = 0; i < 15; i++) {\n                    const bar = document.createElement('div');\n                    bar.className = 'music-bar';\n                    bar.style.height = '10px';\n                    this.container.appendChild(bar);\n                    this.bars.push(bar);\n                }\n                this.animate();\n            }\n            \n            animate() {\n                this.bars.forEach((bar, i) => {\n                    const height = 10 + Math.sin(Date.now() / 300 + i * 0.5) * 15 + Math.random() * 10;\n                    bar.style.height = height + 'px';\n                });\n                requestAnimationFrame(() => this.animate());\n            }\n            \n            pulse(type) {\n                this.bars.forEach((bar, i) => {\n                    setTimeout(() => {\n                        bar.classList.remove('correct', 'wrong');\n                        bar.classList.add(type);\n                        bar.style.height = '60px';\n                        setTimeout(() => {\n                            bar.classList.remove(type);\n                        }, 300);\n                    }, i * 30);\n                });\n            }\n        }\n        \n        // ============ GAME ENGINE ============\n        class GenieGame {\n            constructor() {\n                this.words = [\n                    { word: 'WISHES', hint: 'üåü Three of these come with every lamp' },\n                    { word: 'MAGIC', hint: '‚ú® The force that makes genies powerful' },\n                    { word: 'BOTTLE', hint: 'ü´ô Another name for a genie\\'s home' },\n                    { word: 'MASTER', hint: 'üëë The one who rubs the lamp' },\n                    { word: 'GOLDEN', hint: 'üíõ The color of your precious lamp' },\n                    { word: 'DESERT', hint: 'üèúÔ∏è Where many lamps are found' },\n                    { word: 'SPIRIT', hint: 'üëª What a genie truly is' },\n                    { word: 'COSMIC', hint: 'üåå Your powers span across this realm' },\n                    { word: 'SMOKE', hint: 'üí® You emerge in a puff of this' },\n                    { word: 'ANCIENT', hint: 'üìú How old most genies are' }\n                ];\n                \n                this.narratorMessages = {\n                    start: [\n                        \"üéµ The melody calls out to you... Find the words to summon your lamp! üéµ\",\n                        \"üé∂ Listen closely... the music knows the way home... üé∂\",\n                        \"üéµ Each letter brings you closer to your lamp! üéµ\"\n                    ],\n                    correct: [\n                        \"üé∂ Yes! The harmony grows stronger! üé∂\",\n                        \"üéµ Beautiful! The melody remembers you! üéµ\",\n                        \"‚ú® The music sings with joy! ‚ú®\",\n                        \"üé∂ Perfect note! Keep going! üé∂\"\n                    ],\n                    wrong: [\n                        \"üéµ A discordant note... but don't give up! üéµ\",\n                        \"üíî The melody falters... try another path... üíî\",\n                        \"üé∂ That note doesn't fit... listen again... üé∂\",\n                        \"üòü The song grows weaker... choose wisely... üòü\"\n                    ],\n                    wordComplete: [\n                        \"üéâ A verse complete! The lamp draws nearer! üéâ\",\n                        \"‚ú® Magnificent! The Song of Summoning grows! ‚ú®\",\n                        \"üéµ The magic intensifies! Your lamp feels you! üéµ\"\n                    ],\n                    almostDone: [\n                        \"ü™î You're so close! One more word! ü™î\",\n                        \"‚ú® The lamp glows in the distance! ‚ú®\"\n                    ]\n                };\n                \n                this.currentWordIndex = 0;\n                this.currentWord = '';\n                this.guessedLetters = new Set();\n                this.wrongGuesses = 0;\n                this.maxWrong = 6;\n                this.wordsCompleted = 0;\n                this.totalWordsNeeded = 5;\n                this.totalGuesses = 0;\n                this.totalWrong = 0;\n                \n                this.music = new MusicNarrator();\n                this.visualizer = null;\n                \n                this.init();\n            }\n            \n            init() {\n                this.createStars();\n                this.createKeyboard();\n                this.visualizer = new Visualizer(document.getElementById('visualizer'));\n                this.bindEvents();\n                this.shuffleWords();\n            }\n            \n            createStars() {\n                const starsContainer = document.getElementById('stars');\n                for (let i = 0; i < 100; i++) {\n                    const star = document.createElement('div');\n                    star.className = 'star';\n                    star.style.left = Math.random() * 100 + '%';\n                    star.style.top = Math.random() * 100 + '%';\n                    star.style.width = Math.random() * 3 + 1 + 'px';\n                    star.style.height = star.style.width;\n                    star.style.animationDelay = Math.random() * 2 + 's';\n                    starsContainer.appendChild(star);\n                }\n            }\n            \n            createKeyboard() {\n                const keyboard = document.getElementById('keyboard');\n                const rows = ['QWERTYUIOP', 'ASDFGHJKL', 'ZXCVBNM'];\n                \n                rows.forEach(row => {\n                    const rowDiv = document.createElement('div');\n                    rowDiv.className = 'keyboard-row';\n                    \n                    row.split('').forEach(letter => {\n                        const key = document.createElement('button');\n                        key.className = 'key';\n                        key.textContent = letter;\n                        key.dataset.letter = letter;\n                        key.addEventListener('click', () => this.guess(letter));\n                        rowDiv.appendChild(key);\n                    });\n                    \n                    keyboard.appendChild(rowDiv);\n                });\n            }\n            \n            bindEvents() {\n                document.getElementById('startBtn').addEventListener('click', () => this.startGame());\n                document.getElementById('howToBtn').addEventListener('click', () => this.showOverlay('howToOverlay'));\n                document.getElementById('closeHowTo').addEventListener('click', () => this.hideOverlay('howToOverlay'));\n                document.getElementById('helpBtn').addEventListener('click', () => this.showOverlay('howToOverlay'));\n                document.getElementById('playAgainWin').addEventListener('click', () => this.restartGame());\n                document.getElementById('tryAgain').addEventListener('click', () => this.restartGame());\n                \n                document.getElementById('soundBtn').addEventListener('click', () => {\n                    const muted = this.music.toggleMute();\n                    document.getElementById('soundBtn').textContent = muted ? 'üîá' : 'üîä';\n                    document.getElementById('soundBtn').classList.toggle('muted', muted);\n                });\n                \n                document.addEventListener('keydown', (e) => {\n                    const letter = e.key.toUpperCase();\n                    if (/^[A-Z]$/.test(letter) && !this.guessedLetters.has(letter)) {\n                        this.guess(letter);\n                    }\n                });\n            }\n            \n            shuffleWords() {\n                for (let i = this.words.length - 1; i > 0; i--) {\n                    const j = Math.floor(Math.random() * (i + 1));\n                    [this.words[i], this.words[j]] = [this.words[j], this.words[i]];\n                }\n            }\n            \n            startGame() {\n                this.music.init();\n                this.hideOverlay('startOverlay');\n                this.loadWord();\n                this.updateNarrator(this.getRandomMessage('start'));\n            }\n            \n            restartGame() {\n                this.hideOverlay('winOverlay');\n                this.hideOverlay('loseOverlay');\n                \n                this.wordsCompleted = 0;\n                this.totalGuesses = 0;\n                this.totalWrong = 0;\n                this.currentWordIndex = 0;\n                this.shuffleWords();\n                \n                this.updateProgress();\n                this.loadWord();\n                this.updateNarrator(this.getRandomMessage('start'));\n            }\n            \n            loadWord() {\n                const wordData = this.words[this.currentWordIndex % this.words.length];\n                this.currentWord = wordData.word;\n                this.guessedLetters.clear();\n                this.wrongGuesses = 0;\n                \n                document.getElementById('hint').textContent = wordData.hint;\n                this.renderWord();\n                this.resetKeyboard();\n                this.updateLives();\n                this.updateGenie();\n            }\n            \n            renderWord() {\n                const display = document.getElementById('wordDisplay');\n                display.innerHTML = '';\n                \n                this.currentWord.split('').forEach((letter, i) => {\n                    const slot = document.createElement('div');\n                    slot.className = 'letter-slot';\n                    \n                    if (letter === ' ') {\n                        slot.classList.add('space');\n                    } else if (this.guessedLetters.has(letter)) {\n                        slot.textContent = letter;\n                        slot.classList.add('revealed');\n                    }\n                    \n                    display.appendChild(slot);\n                });\n            }\n            \n            resetKeyboard() {\n                document.querySelectorAll('.key').forEach(key => {\n                    key.className = 'key';\n                });\n            }\n            \n            guess(letter) {\n                if (this.guessedLetters.has(letter)) return;\n                \n                this.guessedLetters.add(letter);\n                this.totalGuesses++;\n                \n                const key = document.querySelector(`.key[data-letter=\"${letter}\"]`);\n                \n                if (this.currentWord.includes(letter)) {\n                    // Correct guess\n                    key.classList.add('correct', 'used');\n                    this.music.playCorrect();\n                    this.visualizer.pulse('correct');\n                    this.updateNarrator(this.getRandomMessage('correct'));\n                    this.renderWord();\n                    \n                    if (this.isWordComplete()) {\n                        this.wordWon();\n                    }\n                } else {\n                    // Wrong guess\n                    key.classList.add('wrong', 'used');\n                    this.wrongGuesses++;\n                    this.totalWrong++;\n                    this.music.playWrong();\n                    this.visualizer.pulse('wrong');\n                    this.updateNarrator(this.getRandomMessage('wrong'));\n                    this.updateLives();\n                    this.updateGenie();\n                    \n                    if (this.wrongGuesses >= this.maxWrong) {\n                        this.gameLose();\n                    }\n                }\n            }\n            \n            isWordComplete() {\n                return this.currentWord.split('').every(\n                    letter => letter === ' ' || this.guessedLetters.has(letter)\n                );\n            }\n            \n            wordWon() {\n                this.wordsCompleted++;\n                this.music.playWordComplete();\n                this.updateProgress();\n                \n                if (this.wordsCompleted >= this.totalWordsNeeded) {\n                    setTimeout(() => this.gameWin(), 1000);\n                } else {\n                    if (this.wordsCompleted === this.totalWordsNeeded - 1) {\n                        this.updateNarrator(this.getRandomMessage('almostDone'));\n                    } else {\n                        this.updateNarrator(this.getRandomMessage('wordComplete'));\n                    }\n                    this.currentWordIndex++;\n                    setTimeout(() => this.loadWord(), 1500);\n                }\n            }\n            \n            updateProgress() {\n                const notes = document.querySelectorAll('.progress-note');\n                notes.forEach((note, i) => {\n                    note.classList.remove('completed', 'current');\n                    if (i < this.wordsCompleted) {\n                        note.classList.add('completed');\n                        note.textContent = '‚ô´';\n                    } else if (i === this.wordsCompleted) {\n                        note.classList.add('current');\n                        note.textContent = '‚ô™';\n                    } else {\n                        note.textContent = '‚ô™';\n                    }\n                });\n            }\n            \n            updateLives() {\n                const lives = document.querySelectorAll('.life');\n                lives.forEach((life, i) => {\n                    if (i < this.maxWrong - this.wrongGuesses) {\n                        life.classList.remove('lost');\n                    } else {\n                        life.classList.add('lost');\n                    }\n                });\n            }\n            \n            updateGenie() {\n                const genie = document.getElementById('genie');\n                const face = document.getElementById('genieFace');\n                const opacity = 1 - (this.wrongGuesses / this.maxWrong) * 0.8;\n                const blur = this.wrongGuesses * 1.5;\n                \n                genie.style.setProperty('--genie-opacity', opacity);\n                genie.style.setProperty('--genie-blur', blur + 'px');\n                \n                const faces = ['üòä', 'üôÇ', 'üòê', 'üòü', 'üò∞', 'üò®', 'üò±'];\n                face.textContent = faces[Math.min(this.wrongGuesses, faces.length - 1)];\n            }\n            \n            updateNarrator(message) {\n                const narrator = document.getElementById('narrator');\n                narrator.innerHTML = `<span>${message}</span>`;\n            }\n            \n            getRandomMessage(type) {\n                const messages = this.narratorMessages[type];\n                return messages[Math.floor(Math.random() * messages.length)];\n            }\n            \n            gameWin() {\n                this.music.playGameWin();\n                this.createConfetti();\n                \n                // Show lamp animation\n                const lamp = document.createElement('div');\n                lamp.className = 'lamp-found';\n                lamp.textContent = 'ü™î';\n                document.body.appendChild(lamp);\n                \n                setTimeout(() => {\n                    lamp.remove();\n                    const accuracy = Math.round((1 - this.totalWrong / this.totalGuesses) * 100);\n                    document.getElementById('winStats').textContent = \n                        `Accuracy: ${accuracy}% | Total guesses: ${this.totalGuesses}`;\n                    this.showOverlay('winOverlay');\n                }, 2000);\n            }\n            \n            gameLose() {\n                this.music.playGameLose();\n                document.getElementById('revealWord').textContent = this.currentWord;\n                setTimeout(() => this.showOverlay('loseOverlay'), 500);\n            }\n            \n            createConfetti() {\n                const colors = ['#ffd700', '#ff69b4', '#00ffff', '#ff8c00', '#9370db'];\n                for (let i = 0; i < 50; i++) {\n                    const confetti = document.createElement('div');\n                    confetti.className = 'confetti';\n                    confetti.style.left = Math.random() * 100 + 'vw';\n                    confetti.style.top = '-20px';\n                    confetti.style.width = Math.random() * 10 + 5 + 'px';\n                    confetti.style.height = confetti.style.width;\n                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];\n                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';\n                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;\n                    document.body.appendChild(confetti);\n                    \n                    const animation = confetti.animate([\n                        { top: '-20px', opacity: 1 },\n                        { top: '100vh', opacity: 0 }\n                    ], {\n                        duration: Math.random() * 2000 + 2000,\n                        easing: 'ease-in'\n                    });\n                    \n                    animation.onfinish = () => confetti.remove();\n                }\n            }\n            \n            showOverlay(id) {\n                document.getElementById(id).classList.add('active');\n            }\n            \n            hideOverlay(id) {\n                document.getElementById(id).classList.remove('active');\n            }\n        }\n        \n        // Initialize game\n        const game = new GenieGame();\n    </script>\n</body>\n</html>"
}
